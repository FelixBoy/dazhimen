<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dazhimen.bg.bean.Permission">
    <select id="queryAllRole" resultType="dazhimen.bg.bean.permission.ListViewRoleBean"
        parameterType="dazhimen.bg.bean.PaginationParamBean">
        select rid,name,introduction,getcodetxt('rightorwrong',ismastercanown) ismastercanown
         from role
        order by rid desc
        limit #{startnum},#{getrows}
    </select>
    <select id="getAllRoleCount" resultType="java.lang.String">
      select count(rid) from role;
    </select>
    <delete id="deleteIrUserRole">
        delete from ir_user_role where rid = #{rid}
    </delete>
    <delete id="deleteIrRoleModule">
        delete from ir_role_module where rid = #{rid}
    </delete>
    <delete id="deleteRole">
        delete from role where rid = #{rid}
    </delete>
    <insert id="saveAddRole" parameterType="dazhimen.bg.bean.permission.AddRoleBean">
        insert into role(rid,name,introduction,ismastercanown)
           values(#{rid}, #{name}, #{introduction}, #{ismastercanown})
    </insert>
    <insert id="saveAddIrRoleModule" parameterType="dazhimen.bg.bean.permission.AddIrRoleModuleBean">
        insert into ir_role_module(rid,mid)
        values(#{rid}, #{mid})
    </insert>

    <select id="getRoleInfor" resultType="dazhimen.bg.bean.permission.ViewRoleInforBean">
       select rid,name,introduction,getcodetxt('rightorwrong',ismastercanown) ismastercanown
         from role
         where rid = #{rid}
    </select>
    <select id="queryIrRoleModule" resultType="dazhimen.bg.bean.permission.ViewIrRoleModuleBean">
      select c.name
       from role a, ir_role_module b,module c
      where a.rid = b.rid
        and b.mid = c.mid
        and a.rid = #{rid}
    </select>

    <select id="getModifyRoleInfor" resultType="dazhimen.bg.bean.permission.ViewRoleInforBean">
        select rid,name,introduction,getcodetxt('rightorwrong',ismastercanown) ismastercanown
        from role
        where rid = #{rid}
    </select>
    <select id="queryIrRoleModuleInModifyRole" resultType="dazhimen.bg.bean.permission.ViewIrRoleModuleBean">
        select a.mid as name
        from ir_role_module a
        where a.rid = #{rid}
    </select>
    <update id="saveModifyRole" parameterType="dazhimen.bg.bean.permission.ModifyRoleBean">
        update role set name = #{name},introduction = #{introduction} where rid = #{rid};
    </update>
</mapper>