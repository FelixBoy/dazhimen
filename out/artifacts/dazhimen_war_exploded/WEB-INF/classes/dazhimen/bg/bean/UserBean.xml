<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dazhimen.bg.bean.User">

    <select id="listAllMaster" resultType="dazhimen.bg.bean.UserBean">
        select uid,name,mphone,getcodetxt('gender',gender) gender,loginname,introduction
          from user
        where type = '1'
          and isdel = '0'
    </select>

    <select id = "checkLoginname" parameterType="string" resultType="dazhimen.bg.bean.SingleValueBean">
        select 1 as valueinfo
          from user
         where loginname = #{loginname}
    </select>

    <insert id="saveAddMater" parameterType="dazhimen.bg.bean.UserBean">
        insert into user(uid,    name,  mphone,   password,   gender,   type,  loginname,identity,introduction,headerimg,createdate)
                  values(#{uid}, #{name}, #{mphone},#{password},#{gender},#{type},#{loginname},#{identity},#{introduction}, #{headerimg},now())
    </insert>

    <select id="getMasterById" resultType="dazhimen.bg.bean.UserBean">
        select uid,name,mphone,gender,loginname,loginname as loginnameorginal,introduction,headerimg,identity
          from user
         where uid = #{uid}
    </select>

    <select id="getAdminById" resultType="dazhimen.bg.bean.UserBean">
        select uid,name,mphone,gender,loginname,loginname as loginnameorginal,remarks
        from user
        where uid = #{uid}
    </select>

    <update id="saveMasterModify" parameterType="dazhimen.bg.bean.UserBean">
        update user
           set name = #{name},mphone = #{mphone},gender = #{gender},
               loginname = #{loginname},introduction = #{introduction},
               identity = #{identity}
        where uid = #{uid}
    </update>

    <update id="saveMasterDel">
        update user
           set isdel = '1',loginname = null,mphone = null
        where uid = #{uid}
    </update>

    <select id="listAllAdmin" resultType="dazhimen.bg.bean.UserBean">
        select uid,name,mphone,getcodetxt('gender',gender) gender,loginname,remarks
        from user
        where type = '2'
        and isdel = '0'
    </select>

    <insert id="saveAddAdmin" parameterType="dazhimen.bg.bean.UserBean">
        insert into user(uid,    name,  mphone,   password,   gender,   type,  loginname,remarks,createdate)
        values(#{uid}, #{name}, #{mphone},#{password},#{gender},#{type},#{loginname},#{remarks}, now())
    </insert>

    <update id="saveModifyAdmin" parameterType="dazhimen.bg.bean.UserBean">
        update user
        set name = #{name},mphone = #{mphone},gender = #{gender},
        loginname = #{loginname},remarks = #{remarks}
        where uid = #{uid}
    </update>

    <update id="saveDelAdmin">
        update user
        set isdel = '1',loginname = null,mphone = null
        where uid = #{uid}
    </update>

</mapper>